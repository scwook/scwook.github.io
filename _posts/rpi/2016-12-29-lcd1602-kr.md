---
layout: post
title: "16x2 Character LCD Test"
language:
  - en
  - kr
categories: RaspberryPi
---
Wiring Pi는 몇가지 하드웨어를 위한 [Device Driver Library](http://wiringpi.com/dev-lib/)를 제공하고 있다. 여기에서는 Hitachi HD44780U기반의 16x2 Character LCD에 현재시간을 표시하는 테스트를 진행한다. 테스트를 위해서는 [WiringPi]({{site.url}}/raspberrypi/2016/05/20/wiringPi-installation-kr.html)가 설치되어 있어야 한다.

### Component

* Raspberry Pi 2 Model B
* [LCD1620](http://www.waveshare.com/lcd1602-blue.htm)
* Resistor 1~2kΩ

![LCD1602 Test Circuit]({{site.url}}/images/rpi_lcd1602_test.png)

### Source Code

filename: lcd1602Test.c

{% highlight c linenos %}
#include <stdio.h>
#include <wiringPi.h>
#include <lcd.h>
#include <time.h>

#define TRUE 1
#define FALSE 0

int main(void)
{
  if(wiringPiSetup() == -1)
  {
    printf("Unable to start wiringPi\n");
    return 1;
  }

  int fd;

  fd = lcdInit(2, 16, 4, 4,5, 0,1,2,3,0,0,0,0);

  printf("%d\n", fd);

  lcdHome(fd);
  lcdCursor(fd, TRUE);
  lcdCursorBlink(fd, FALSE);

  struct tm *t;
  time_t timer;

  while(TRUE)
  {
    timer = time(NULL);
    t = localtime(&timer);

    lcdPosition(fd, 0,0);
    lcdPrintf(fd, "%4d.%02d.%02d", t->tm_year+1900, t->tm_mon+1, t->tm_mday);

    lcdPosition(fd, 0,1);
    lcdPrintf(fd, "%02d:%02d:%02d", t->tm_hour, t->tm_min, t->tm_sec);

    delay(100);
  }
  return 0;
}
{% endhighlight %}

컴파일 후 프로그램을 실행한다.

{% highlight console %}
pi@raspberrypi ~$ gcc -o lcd1602Test lcd1602Test.c -lwiringPi -lwiringPiDev
pi@raspberrypi ~$ sudo ./lcd1602Test
{% endhighlight %}

LCD에 현재시간이 표시되는 것을 확인할 수 있다.
